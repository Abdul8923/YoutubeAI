<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Course Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
        color: #e2e8f0; /* Default light text color for dark mode */
      }
      /* Custom scrollbar for dark theme */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #1e293b; /* slate-800 */
      }
      ::-webkit-scrollbar-thumb {
        background: #475569; /* slate-600 */
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b; /* slate-500 */
      }
      @keyframes fade-in-up {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fade-in-up {
        animation: fade-in-up 0.6s ease-out forwards;
        opacity: 0; /* Start hidden */
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "@google/genai": "https://esm.sh/@google/genai",
    "jspdf": "https://esm.sh/jspdf@2.5.1"
  }
}
</script>
</head>
  <body class="bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 antialiased">
    <div id="root"></div>
    <script type="module">
      import React, { useState, useCallback } from 'react';
      import ReactDOM from 'react-dom/client';
      import { GoogleGenAI, Type } from "@google/genai";
      import { jsPDF } from "jspdf";

      // --- START OF ICONS ---
      const BookOpenIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" })
        )
      );

      const CheckCircleIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" })
        )
      );

      const XCircleIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" })
        )
      );

      const ChevronDownIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M19.5 8.25l-7.5 7.5-7.5-7.5" })
        )
      );

      const LinkIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" })
        )
      );

      const ArrowRightIcon = (props) => (
          React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
              React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" })
          )
      );

      const LogoIcon = (props) => (
          React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "currentColor", ...props },
              React.createElement('path', { fillRule: "evenodd", d: "M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm14.024-.983a1.125 1.125 0 010 1.966l-5.603 3.113A1.125 1.125 0 019 15.113V8.887c0-.857.921-1.4 1.671-.983l5.603 3.113z", clipRule: "evenodd" })
          )
      );
      
      const TagIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" }),
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M6 6h.008v.008H6V6z" })
        )
      );

      const ArrowDownTrayIcon = (props) => (
        React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props },
          React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" })
        )
      );
      // --- END OF ICONS ---
      
      // --- START OF SERVICES/GEMINISERVICE.TS ---
      const API_KEY = process.env.API_KEY;
      
      if (!API_KEY) {
        // In a real app, you might show this in the UI
        console.error("API_KEY environment variable is not set");
        const rootDiv = document.getElementById('root');
        if(rootDiv) {
            rootDiv.innerHTML = '<div style="color: red; padding: 20px; text-align: center; font-size: 1.2em;">Error: API_KEY is not configured. Please set the API_KEY environment variable.</div>';
        }
      }
      
      const ai = new GoogleGenAI({ apiKey: API_KEY });
      
      const courseSchema = {
        type: Type.OBJECT,
        properties: {
          title: { type: Type.STRING, description: "A compelling and relevant title for the course based on the video's content." },
          description: { type: Type.STRING, description: "A brief, one-paragraph summary of what the course covers." },
          keyTakeaways: {
            type: Type.ARRAY,
            items: { type: Type.STRING },
            description: "A list of 3-5 key learning points or takeaways from the video."
          },
          modules: {
            type: Type.ARRAY,
            description: "A list of 3-4 structured modules. Each module should represent a distinct section or topic from the video.",
            items: {
              type: Type.OBJECT,
              properties: {
                moduleTitle: { type: Type.STRING, description: "The title of the module." },
                summary: { type: Type.STRING, description: "A detailed summary of the concepts covered in this module." },
                quiz: {
                  type: Type.ARRAY,
                  description: "A quiz with 2-3 multiple-choice questions to test understanding of the module's content.",
                  items: {
                    type: Type.OBJECT,
                    properties: {
                      question: { type: Type.STRING, description: "The quiz question." },
                      options: {
                        type: Type.ARRAY,
                        items: { type: Type.STRING },
                        description: "An array of 4 possible answers."
                      },
                      correctAnswer: { type: Type.STRING, description: "The correct option from the 'options' array." }
                    },
                    required: ["question", "options", "correctAnswer"]
                  }
                }
              },
              required: ["moduleTitle", "summary", "quiz"]
            }
          }
        },
        required: ["title", "description", "keyTakeaways", "modules"]
      };

      const generateCourse = async (url, title) => {
          const titlePromptSection = title
            ? `The user has also provided a title for the video: "${title}". Use this title as a strong contextual clue for the video's content.`
            : `Analyze the content of the video at the provided URL to determine its topic.`;

          const prompt = `You are an AI specializing in creating educational content. Your sole task is to generate a structured mini-course based *only* on the content of a single YouTube video.

          The user has provided this URL: "${url}"
          ${titlePromptSection}

          It is absolutely crucial that the course content you generate is directly and exclusively derived from the specific subject matter of this single video. Do not create a general course on the broad topic; instead, create a course that reflects what one would learn from watching this particular video. For example, if the video is 'Learn CSS Grid in 20 Minutes', the course should cover only the concepts presented in that video, not the entirety of CSS Grid.

          Your entire output must be a single, valid JSON object that adheres to the provided schema. Do not include any text, explanations, or markdown formatting outside of the JSON object.`;
          
          try {
            const response = await ai.models.generateContent({
              model: "gemini-2.5-flash",
              contents: prompt,
              config: {
                responseMimeType: "application/json",
                responseSchema: courseSchema,
                temperature: 0.7,
              },
            });

            const rawText = response.text;
            if (!rawText) {
              throw new Error("Received an empty response from the AI service.");
            }

            try {
              const startIndex = rawText.indexOf('{');
              const endIndex = rawText.lastIndexOf('}');

              if (startIndex === -1 || endIndex === -1 || endIndex < startIndex) {
                console.error("No valid JSON object found in response:", rawText);
                throw new Error("Response did not contain a valid JSON object.");
              }

              const jsonString = rawText.substring(startIndex, endIndex + 1);
              const courseData = JSON.parse(jsonString);

              if (!courseData.title || !courseData.modules || !Array.isArray(courseData.modules)) {
                console.error("Parsed JSON is missing required fields:", courseData);
                throw new Error("AI returned incomplete course data.");
              }

              return courseData;

            } catch (parseError) {
              console.error("Error parsing JSON from Gemini response:", parseError);
              console.error("Raw response text for debugging:", rawText);
              throw new Error("AI returned malformed data that could not be parsed.");
            }

          } catch (error) {
            console.error("Error in generateCourse:", error);
            throw error;
          }
      };
      // --- END OF SERVICES/GEMINISERVICE.TS ---

      // --- START OF COMPONENTS ---
      const LoadingSpinner = () => {
        return (
          React.createElement('svg', { 
            className: "animate-spin h-12 w-12 text-blue-600", 
            xmlns: "http://www.w3.org/2000/svg", 
            fill: "none", 
            viewBox: "0 0 24 24"
          },
            React.createElement('circle', { 
              className: "opacity-25", 
              cx: "12", 
              cy: "12", 
              r: "10", 
              stroke: "currentColor", 
              strokeWidth: "4"
            }),
            React.createElement('path', { 
              className: "opacity-75", 
              fill: "currentColor", 
              d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            })
          )
        );
      };
      
      const URLInputForm = ({ onSubmit, isLoading }) => {
        const [url, setUrl] = useState('');
        const [title, setTitle] = useState('');

        const handleSubmit = (e) => {
          e.preventDefault();
          onSubmit({ url, title });
        };

        return (
          React.createElement('form', { onSubmit: handleSubmit, className: "space-y-4" },
            React.createElement('div', { className: "space-y-3" },
              React.createElement('div', { className: "relative flex-grow w-full" },
                React.createElement(LinkIcon, { className: "absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-500" }),
                React.createElement('input', {
                  type: "url",
                  value: url,
                  onChange: (e) => setUrl(e.target.value),
                  placeholder: "https://www.youtube.com/watch?v=...",
                  className: "w-full pl-11 pr-4 py-3 bg-slate-700/50 rounded-lg border border-slate-600 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150 ease-in-out shadow-sm placeholder:text-slate-500",
                  required: true,
                  disabled: isLoading
                })
              ),
              React.createElement('div', { className: "relative flex-grow w-full" },
                React.createElement(TagIcon, { className: "absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-500" }),
                React.createElement('input', {
                  type: "text",
                  value: title,
                  onChange: (e) => setTitle(e.target.value),
                  placeholder: "Video Title (optional, improves accuracy)",
                  className: "w-full pl-11 pr-4 py-3 bg-slate-700/50 rounded-lg border border-slate-600 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150 ease-in-out shadow-sm placeholder:text-slate-500",
                  disabled: isLoading
                })
              )
            ),
            React.createElement('button', {
              type: "submit",
              disabled: isLoading,
              className: "w-full flex items-center justify-center px-6 py-3 bg-gradient-to-r from-indigo-500 to-violet-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl hover:from-indigo-600 hover:to-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-slate-700 disabled:from-slate-700 disabled:to-slate-700 disabled:text-slate-400 disabled:cursor-not-allowed transform hover:scale-[1.02] transition-all duration-200"
            },
              isLoading ? 'Generating...' : React.createElement(React.Fragment, null, 
                React.createElement('span', null, 'Create Course'),
                React.createElement(ArrowRightIcon, { className: "ml-2 h-5 w-5" })
              )
            )
          )
        );
      };
      
      const Quiz = ({ questions }) => {
        const [selectedAnswers, setSelectedAnswers] = useState({});
        const [isSubmitted, setIsSubmitted] = useState(false);

        const handleSelectAnswer = (questionIndex, option) => {
          if (isSubmitted) return;
          setSelectedAnswers(prev => ({
            ...prev,
            [questionIndex]: option,
          }));
        };

        const getOptionClass = (question, questionIndex, option) => {
          if (!isSubmitted) {
            return selectedAnswers[questionIndex] === option 
              ? 'bg-indigo-500/30 border-indigo-500 ring-2 ring-indigo-500/50' 
              : 'bg-slate-700/40 border-slate-600 hover:bg-slate-600/60 hover:border-slate-500';
          }

          const isCorrect = option === question.correctAnswer;
          const isSelected = selectedAnswers[questionIndex] === option;

          if (isCorrect) return 'bg-green-500/20 border-green-500';
          if (isSelected && !isCorrect) return 'bg-red-500/20 border-red-500';
          return 'bg-slate-700/20 border-slate-700 opacity-60';
        };

        const allAnswered = Object.keys(selectedAnswers).length === questions.length;

        return React.createElement('div', { className: "space-y-6" },
          questions.map((q, qIndex) => (
            React.createElement('div', { key: qIndex, className: "p-4 bg-slate-900/30 border border-slate-700 rounded-lg" },
              React.createElement('p', { className: "font-semibold text-slate-200 mb-3" }, `${qIndex + 1}. ${q.question}`),
              React.createElement('div', { className: "space-y-2" },
                q.options.map((option, oIndex) => (
                  React.createElement('button', {
                    key: oIndex,
                    onClick: () => handleSelectAnswer(qIndex, option),
                    disabled: isSubmitted,
                    className: `w-full text-left p-3 rounded-md border transition-all duration-150 flex items-center justify-between ${getOptionClass(q, qIndex, option)}`
                  },
                    React.createElement('span', { className: "text-slate-300" }, option),
                    isSubmitted && option === q.correctAnswer && React.createElement(CheckCircleIcon, { className: "h-5 w-5 text-green-400" }),
                    isSubmitted && selectedAnswers[qIndex] === option && option !== q.correctAnswer && React.createElement(XCircleIcon, { className: "h-5 w-5 text-red-400" })
                  )
                ))
              )
            )
          )),
          React.createElement('div', { className: "mt-6 flex justify-end" },
            !isSubmitted ? (
              React.createElement('button', {
                onClick: () => setIsSubmitted(true),
                disabled: !allAnswered,
                className: "px-6 py-2 bg-gradient-to-r from-indigo-500 to-violet-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:from-indigo-600 hover:to-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 focus:ring-indigo-500 disabled:bg-slate-700 disabled:from-slate-700 disabled:to-slate-700 disabled:text-slate-400 disabled:cursor-not-allowed transform hover:scale-105 transition-all"
              }, 'Submit Quiz')
            ) : (
              React.createElement('button', {
                onClick: () => {
                  setIsSubmitted(false);
                  setSelectedAnswers({});
                },
                className: "px-6 py-2 bg-slate-200 text-slate-800 font-semibold rounded-lg shadow-sm hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 focus:ring-slate-400 transition-colors"
              }, 'Try Again')
            )
          )
        );
      };
      
      const CourseModule = ({ module, index }) => {
        const [isOpen, setIsOpen] = useState(index === 0);

        return (
          React.createElement('div', { className: "bg-slate-800/50 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60 overflow-hidden transition-all duration-300" },
            React.createElement('button', {
              onClick: () => setIsOpen(!isOpen),
              className: "w-full flex justify-between items-center text-left p-6 hover:bg-slate-700/50 transition-colors duration-200"
            },
              React.createElement('div', { className: "flex items-center space-x-4" },
                React.createElement('div', { className: "flex-shrink-0 h-10 w-10 flex items-center justify-center bg-indigo-900/70 rounded-full" },
                  React.createElement('span', { className: "text-lg font-bold text-indigo-300" }, String(index + 1).padStart(2, '0'))
                ),
                React.createElement('h3', { className: "text-xl font-semibold text-slate-200" }, module.moduleTitle)
              ),
              React.createElement(ChevronDownIcon, {
                className: `h-6 w-6 text-slate-400 transform transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`
              })
            ),
            React.createElement('div', {
              className: `transition-all duration-500 ease-in-out ${isOpen ? 'max-h-[2000px] opacity-100' : 'max-h-0 opacity-0'} overflow-hidden`
            },
              React.createElement('div', { className: "px-6 pb-6 pt-2 space-y-6" },
                React.createElement('div', { className: "border-t border-slate-700 pt-4" },
                  React.createElement('h4', { className: "font-semibold text-slate-300 mb-2" }, 'Summary'),
                  React.createElement('p', { className: "text-slate-400 leading-relaxed prose prose-invert" }, module.summary)
                ),
                React.createElement('div', null,
                  React.createElement('h4', { className: "font-semibold text-slate-300 mb-4" }, 'Knowledge Check'),
                  React.createElement(Quiz, { questions: module.quiz })
                )
              )
            )
          )
        );
      };
      
      const CourseDisplay = ({ course, youtubeVideoId }) => {
        const contentBlocks = [
          { type: 'header', data: course },
          { type: 'video', data: youtubeVideoId },
          { type: 'takeaways', data: course.keyTakeaways },
          { type: 'modulesTitle', data: null },
          ...course.modules.map(module => ({ type: 'module', data: module }))
        ];

        return (
          React.createElement('div', { className: "space-y-6" },
            contentBlocks.map((block, index) => {
              if (!block.data && block.type !== 'modulesTitle') return null;

              const style = { animationDelay: `${index * 100}ms` };

              switch (block.type) {
                case 'header':
                  return React.createElement('header', { key: index, style: style, className: "bg-slate-800/50 p-8 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60 animate-fade-in-up" },
                    React.createElement('h1', { className: "text-3xl font-bold text-slate-100 tracking-tight" }, course.title),
                    React.createElement('p', { className: "mt-3 text-lg text-slate-300" }, course.description)
                  );
                case 'video':
                  return youtubeVideoId && React.createElement('div', { key: index, style: style, className: "bg-slate-800/50 p-4 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60 animate-fade-in-up" },
                    React.createElement('div', { className: "relative", style: { paddingTop: '56.25%' } },
                      React.createElement('iframe', {
                        className: "absolute top-0 left-0 w-full h-full rounded-lg",
                        src: `https://www.youtube.com/embed/${youtubeVideoId}`,
                        title: "YouTube video player",
                        frameBorder: "0",
                        allow: "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",
                        allowFullScreen: true
                      })
                    )
                  );
                case 'takeaways':
                  return React.createElement('div', { key: index, style: style, className: "bg-slate-800/50 p-8 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60 animate-fade-in-up" },
                    React.createElement('h2', { className: "text-2xl font-semibold text-slate-200 mb-4" }, 'Key Takeaways'),
                    React.createElement('ul', { className: "space-y-3" },
                      course.keyTakeaways.map((takeaway, tIndex) => (
                        React.createElement('li', { key: tIndex, className: "flex items-start" },
                          React.createElement(CheckCircleIcon, { className: "h-6 w-6 text-green-400 mr-3 mt-1 flex-shrink-0" }),
                          React.createElement('span', { className: "text-slate-300" }, takeaway)
                        )
                      ))
                    )
                  );
                case 'modulesTitle':
                  return React.createElement('h2', { key: index, style: style, className: "text-2xl font-semibold text-slate-200 pt-4 animate-fade-in-up" }, 'Course Modules');
                case 'module':
                  const moduleIndex = course.modules.findIndex(m => m.moduleTitle === block.data.moduleTitle);
                  return React.createElement('div', { key: index, style: style, className: "animate-fade-in-up" },
                    React.createElement(CourseModule, { module: block.data, index: moduleIndex })
                  );
                default:
                  return null;
              }
            })
          )
        );
      };
      // --- END OF COMPONENTS ---

      // --- START OF APP.TSX ---
      const App = () => {
        const [isLoading, setIsLoading] = useState(false);
        const [courseData, setCourseData] = useState(null);
        const [error, setError] = useState(null);
        const [youtubeVideoId, setYoutubeVideoId] = useState(null);

        const extractYouTubeID = (url) => {
          const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
          const match = url.match(regExp);
          return (match && match[2].length === 11) ? match[2] : null;
        };
        
        const handleDownloadPdf = useCallback(() => {
            if (!courseData) return;

            const doc = new jsPDF({
                orientation: 'p',
                unit: 'mm',
                format: 'a4'
            });

            const pageWidth = doc.internal.pageSize.getWidth();
            const margin = 15;
            const maxLineWidth = pageWidth - margin * 2;
            let y = 20;

            const addPageIfNeeded = (spaceNeeded) => {
                if (y + spaceNeeded > 280) { // 297mm page height, with some margin
                    doc.addPage();
                    y = 20;
                }
            };

            const writeText = (text, options) => {
                doc.setFont(options.font || 'helvetica', options.style || 'normal');
                doc.setFontSize(options.size || 10);
                doc.setTextColor(options.color || '#000000');
                
                const lines = doc.splitTextToSize(text, maxLineWidth);
                const textHeight = doc.getTextDimensions(lines).h;
                
                addPageIfNeeded(textHeight);
                
                doc.text(lines, margin, y);
                y += textHeight + (options.spacing || 5);
            };

            writeText(courseData.title, { size: 22, style: 'bold', spacing: 10 });
            writeText(courseData.description, { size: 12, style: 'italic', spacing: 10 });

            addPageIfNeeded(20);
            y += 5;
            writeText('Key Takeaways', { size: 16, style: 'bold', spacing: 7 });
            courseData.keyTakeaways.forEach(takeaway => {
                writeText(`• ${takeaway}`, { size: 11, spacing: 4 });
            });

            courseData.modules.forEach((module, index) => {
                addPageIfNeeded(30);
                y += 10;
                writeText(`Module ${index + 1}: ${module.moduleTitle}`, { size: 16, style: 'bold', spacing: 7 });
                
                writeText('Summary:', { size: 12, style: 'bold', spacing: 4 });
                writeText(module.summary, { size: 11, spacing: 8 });

                writeText('Knowledge Check:', { size: 12, style: 'bold', spacing: 4 });
                module.quiz.forEach((q, qIndex) => {
                    addPageIfNeeded(25);
                    writeText(`${qIndex + 1}. ${q.question}`, { size: 11, style: 'bold', spacing: 4 });
                    q.options.forEach(opt => {
                         writeText(`  - ${opt}`, { size: 10, spacing: 3 });
                    });
                    writeText(`Correct Answer: ${q.correctAnswer}`, { size: 10, style: 'italic', spacing: 6 });
                });
            });

            doc.save(`${courseData.title.replace(/\s+/g, '_').toLowerCase()}_course.pdf`);

        }, [courseData]);

        const handleGenerateCourse = useCallback(async ({ url, title }) => {
          if (!url) {
            setError('Please enter a valid YouTube URL.');
            return;
          }

          const videoId = extractYouTubeID(url);
          if (!videoId) {
              setError('Could not extract video ID. Please use a valid YouTube video URL.');
              return;
          }

          setIsLoading(true);
          setError(null);
          setCourseData(null);
          setYoutubeVideoId(null);

          try {
            if (!API_KEY) throw new Error("API_KEY is not set.");
            const data = await generateCourse(url, title);
            setCourseData(data);
            setYoutubeVideoId(videoId);
          } catch (err) {
            console.error(err);
            setError(`Failed to generate course. ${err.message}`);
          } finally {
            setIsLoading(false);
          }
        }, []);

        return (
          React.createElement('div', { className: "min-h-screen text-slate-300" },
            React.createElement('header', { className: "bg-slate-900/70 backdrop-blur-xl sticky top-0 z-10 border-b border-slate-700/80" },
              React.createElement('div', { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
                React.createElement('div', { className: "flex items-center justify-between h-16" },
                  React.createElement('div', { className: "flex items-center space-x-3" },
                    React.createElement(LogoIcon, { className: "h-8 w-8 text-indigo-400" }),
                    React.createElement('h1', { className: "text-xl sm:text-2xl font-bold text-slate-100 tracking-tight" }, 'YouTubeCourse AI')
                  ),
                  courseData && !isLoading && React.createElement('button', {
                    onClick: handleDownloadPdf,
                    className: "flex items-center justify-center px-4 py-2 bg-gradient-to-r from-red-600 to-rose-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl hover:from-red-700 hover:to-rose-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-red-500 transform hover:scale-[1.03] transition-all duration-200"
                  },
                    React.createElement(ArrowDownTrayIcon, { className: "h-5 w-5 mr-2" }),
                    'Download PDF'
                  )
                )
              )
            ),
            React.createElement('main', { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12" },
              React.createElement('div', { className: "max-w-3xl mx-auto" },
                React.createElement('div', { className: "text-center mb-10" },
                  React.createElement('h2', { className: "text-4xl sm:text-5xl font-extrabold text-slate-100 tracking-tight" }, 'Transform Video into',
                    React.createElement('span', { className: "block bg-gradient-to-r from-indigo-400 to-violet-500 bg-clip-text text-transparent" }, 'Actionable Knowledge')
                  ),
                  React.createElement('p', { className: "mt-4 text-lg text-slate-400 max-w-2xl mx-auto" }, 'Paste a YouTube link below. Adding the video title helps our AI create a more accurate course.')
                ),
                React.createElement('div', { className: "bg-slate-800/50 p-6 sm:p-8 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60" },
                  React.createElement(URLInputForm, { onSubmit: handleGenerateCourse, isLoading: isLoading })
                ),
                React.createElement('div', { className: "mt-12" },
                  isLoading && React.createElement('div', { className: "flex flex-col items-center justify-center text-center text-slate-400" },
                    React.createElement(LoadingSpinner, null),
                    React.createElement('p', { className: "mt-4 text-lg font-medium" }, 'Generating your course...'),
                    React.createElement('p', { className: "text-sm" }, "This may take a moment. We're crafting the perfect learning path for you!")
                  ),
                  error && React.createElement('div', { className: "bg-red-900/50 border-l-4 border-red-600 text-red-300 p-4 rounded-md shadow-md", role: "alert" },
                    React.createElement('p', { className: "font-bold" }, 'An Error Occurred'),
                    React.createElement('p', null, error)
                  ),
                  courseData && youtubeVideoId && !isLoading && React.createElement(CourseDisplay, { course: courseData, youtubeVideoId: youtubeVideoId }),
                  !courseData && !isLoading && !error && (
                    React.createElement('div', { className: "text-center bg-slate-800/50 p-12 rounded-2xl shadow-xl backdrop-blur-xl border border-slate-700/60" },
                      React.createElement(BookOpenIcon, { className: "mx-auto h-16 w-16 text-slate-600" }),
                      React.createElement('h3', { className: "mt-4 text-xl font-semibold text-slate-200" }, 'Your Course Awaits'),
                      React.createElement('p', { className: "mt-2 text-slate-400" }, 'Enter a YouTube URL above to begin your learning journey.')
                    )
                  )
                )
              )
            )
          )
        );
      };
      // --- END OF APP.TSX ---

      // --- START OF INDEX.TSX (Entry Point) ---
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }
      
      const root = ReactDOM.createRoot(rootElement);
      root.render(React.createElement(React.StrictMode, null, React.createElement(App, null)));
      // --- END OF INDEX.TSX ---
    </script>
  </body>
</html>